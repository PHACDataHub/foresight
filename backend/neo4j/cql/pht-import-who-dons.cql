/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Import WHO Disease Outbreak News Articles
//
CALL apoc.load.json("file:///v3_classification.jsonl") YIELD value AS pair_list
WITH pair_list
    UNWIND pair_list.result AS pair
    MERGE (t1:Threat {text: pair[0]})
    MERGE (t2:Threat {text: pair[1]})
    MERGE (t1)<-[:PART_OF]-(t2)
RETURN pair;
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Connect WHO Disease Outbreak News Articles
//
CALL apoc.load.json("file:///who-dons.jsonl") YIELD value AS doc
WITH doc
    MERGE (n:DON {url: doc.url})
        SET n.content = doc.text,
            n. summary = doc.sum
WITH doc, n
    UNWIND doc.ground_truth AS threat 
    MERGE (t:Threat {text: threat})
    MERGE (n)-[:DETECTED_THREAT]->(t)
RETURN DISTINCT(n.url) AS url;
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
